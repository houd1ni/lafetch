"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __assign=function(){return(__assign=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var u in e=arguments[t])Object.prototype.hasOwnProperty.call(e,u)&&(r[u]=e[u]);return r}).apply(this,arguments)};function __awaiter(r,e,t,n){return new(t||(t=Promise))(function(u,i){function c(r){try{o(n.next(r))}catch(r){i(r)}}function a(r){try{o(n.throw(r))}catch(r){i(r)}}function o(r){r.done?u(r.value):new t(function(e){e(r.value)}).then(c,a)}o((n=n.apply(r,e||[])).next())})}function __generator(r,e){var t,n,u,i,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,n&&(u=2&i[0]?n.return:i[0]?n.throw||((u=n.return)&&u.call(n),0):n.next)&&!(u=u.call(n,i[1])).done)return u;switch(n=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(u=(u=c.trys).length>0&&u[u.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){c.label=i[1];break}if(6===i[0]&&c.label<u[1]){c.label=u[1],u=i;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(i);break}u[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(r,c)}catch(r){i=[6,r],n=0}finally{t=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function _isPlaceholder(r){return null!=r&&"object"==typeof r&&!0===r["@@functional/placeholder"]}var _isPlaceholder_1=_isPlaceholder;function _curry1(r){return function e(t){return 0===arguments.length||_isPlaceholder_1(t)?e:r.apply(this,arguments)}}var _curry1_1=_curry1;function _curry2(r){return function e(t,n){switch(arguments.length){case 0:return e;case 1:return _isPlaceholder_1(t)?e:_curry1_1(function(e){return r(t,e)});default:return _isPlaceholder_1(t)&&_isPlaceholder_1(n)?e:_isPlaceholder_1(t)?_curry1_1(function(e){return r(e,n)}):_isPlaceholder_1(n)?_curry1_1(function(e){return r(t,e)}):r(t,n)}}}var _curry2_1=_curry2;function _curry3(r){return function e(t,n,u){switch(arguments.length){case 0:return e;case 1:return _isPlaceholder_1(t)?e:_curry2_1(function(e,n){return r(t,e,n)});case 2:return _isPlaceholder_1(t)&&_isPlaceholder_1(n)?e:_isPlaceholder_1(t)?_curry2_1(function(e,t){return r(e,n,t)}):_isPlaceholder_1(n)?_curry2_1(function(e,n){return r(t,e,n)}):_curry1_1(function(e){return r(t,n,e)});default:return _isPlaceholder_1(t)&&_isPlaceholder_1(n)&&_isPlaceholder_1(u)?e:_isPlaceholder_1(t)&&_isPlaceholder_1(n)?_curry2_1(function(e,t){return r(e,t,u)}):_isPlaceholder_1(t)&&_isPlaceholder_1(u)?_curry2_1(function(e,t){return r(e,n,t)}):_isPlaceholder_1(n)&&_isPlaceholder_1(u)?_curry2_1(function(e,n){return r(t,e,n)}):_isPlaceholder_1(t)?_curry1_1(function(e){return r(e,n,u)}):_isPlaceholder_1(n)?_curry1_1(function(e){return r(t,e,u)}):_isPlaceholder_1(u)?_curry1_1(function(e){return r(t,n,e)}):r(t,n,u)}}}var _curry3_1=_curry3;function _isObject(r){return"[object Object]"===Object.prototype.toString.call(r)}var _isObject_1=_isObject;function _has(r,e){return Object.prototype.hasOwnProperty.call(e,r)}var _has_1=_has,mergeWithKey=_curry3_1(function(r,e,t){var n,u={};for(n in e)_has_1(n,e)&&(u[n]=_has_1(n,t)?r(n,e[n],t[n]):e[n]);for(n in t)_has_1(n,t)&&!_has_1(n,u)&&(u[n]=t[n]);return u}),mergeWithKey_1=mergeWithKey,mergeDeepWithKey=_curry3_1(function r(e,t,n){return mergeWithKey_1(function(t,n,u){return _isObject_1(n)&&_isObject_1(u)?r(e,n,u):e(t,n,u)},t,n)}),mergeDeepWithKey_1=mergeDeepWithKey,mergeDeepRight=_curry2_1(function(r,e){return mergeDeepWithKey_1(function(r,e,t){return t},r,e)}),mergeDeepRight_1=mergeDeepRight;function _arity(r,e){switch(r){case 0:return function(){return e.apply(this,arguments)};case 1:return function(r){return e.apply(this,arguments)};case 2:return function(r,t){return e.apply(this,arguments)};case 3:return function(r,t,n){return e.apply(this,arguments)};case 4:return function(r,t,n,u){return e.apply(this,arguments)};case 5:return function(r,t,n,u,i){return e.apply(this,arguments)};case 6:return function(r,t,n,u,i,c){return e.apply(this,arguments)};case 7:return function(r,t,n,u,i,c,a){return e.apply(this,arguments)};case 8:return function(r,t,n,u,i,c,a,o){return e.apply(this,arguments)};case 9:return function(r,t,n,u,i,c,a,o,s){return e.apply(this,arguments)};case 10:return function(r,t,n,u,i,c,a,o,s,_){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}var _arity_1=_arity;function _curryN(r,e,t){return function(){for(var n=[],u=0,i=r,c=0;c<e.length||u<arguments.length;){var a;c<e.length&&(!_isPlaceholder_1(e[c])||u>=arguments.length)?a=e[c]:(a=arguments[u],u+=1),n[c]=a,_isPlaceholder_1(a)||(i-=1),c+=1}return i<=0?t.apply(this,n):_arity_1(i,_curryN(r,n,t))}}var _curryN_1=_curryN,curryN=_curry2_1(function(r,e){return 1===r?_curry1_1(e):_arity_1(r,_curryN_1(r,[],e))}),curryN_1=curryN,curry=_curry1_1(function(r){return curryN_1(r.length,r)}),curry_1=curry,_this=void 0,trim=curry_1(function(r,e){for(var t,n=null,u=null,i=0;i<e.length;i++)t=e[i],r.includes(t)?n&&(u=i):(null==n&&(n=i),u=null);return e.slice(n||0,u||e.length)}),asyncpipe=function(){var r=function(e,t,n){return __awaiter(_this,void 0,void 0,function(){var u,i,c;return __generator(this,function(a){switch(a.label){case 0:return~n?(i=r,c=[e],[4,e[n](t)]):[3,3];case 1:return[4,i.apply(void 0,c.concat([a.sent(),--n]))];case 2:return u=a.sent(),[3,4];case 3:u=t,a.label=4;case 4:return[2,u]}})})};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return r(e,t,e.length-1)}}}(),formURI=function(r){var e=[];if(r.params){var t=[];Object.entries(r.params).forEach(function(r){var e=r[0],n=r[1];n&&(n=String(n),t.push(e+"="+n.replace(/&/g,"\\&")))}),t.length&&e.push("?"+t.join("&"))}return encodeURI(r.url+e.map(trim("-")).join("/"))},trimSlash=trim("/"),addBase=function(r,e){return e.includes("://")||e.startsWith(r)?e:trimSlash(r)+"/"+trimSlash(e)},default_config={base:"/",json:!0,headers:{},middleware:[]},Fetch=function(){function r(r){var e=this;this.basic_middleware=[function(r){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return r.url=formURI(r),[2,r]})})},function(r){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return r.url=addBase(this.config.base,r.url),[2,r]})})}],this.config=Object.assign({},default_config,r),this.basic_query={url:"",method:"get",headers:{},params:{},json:this.config.json},this.applyMiddleware=asyncpipe.apply(void 0,this.config.middleware.concat(this.basic_middleware))}return r.prototype.query=function(r){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.applyMiddleware(mergeDeepRight_1(this.basic_query,r))];case 1:return(r=n.sent()).result?[2,r.result]:[3,2];case 2:return[4,fetch(r.url,{method:r.method,headers:r.headers})];case 3:return e=n.sent(),r.json?[4,e.json()]:[3,5];case 4:return t=n.sent(),[3,6];case 5:t=e,n.label=6;case 6:return[2,t]}})})},r}(),addHeaders=curry_1(function(r,e){return __assign({},e,{headers:Object.assign({},e.headers,r)})});exports.Fetch=Fetch,exports.addHeaders=addHeaders,exports.formURI=formURI;
